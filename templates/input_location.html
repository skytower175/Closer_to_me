{% extends "base.html" %}
{% block title %}Geolocation{% endblock %}
{% block content %}
  <h2>Geolocation</h2>
  {% if geo_data %}
    {% if geo_data.lat and geo_data.lon %}
      <div id="map" style="height: 400px;"></div>
      <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
      <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
      <script>
        var map = L.map('map').setView([{{ geo_data.lat|float }}, {{ geo_data.lon|float }}], 13);
        L.tileLayer('https://maps.geoapify.com/v1/tile/osm-liberty/{z}/{x}/{y}.png?apiKey=YOUR_GEOAPIFY_API_KEY', {
          attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://www.geoapify.com/">Geoapify</a>',
          maxZoom: 20
        }).addTo(map);
        L.marker([{{ geo_data.lat|float }}, {{ geo_data.lon|float }}], { draggable: true }).addTo(map)
          .bindPopup('You are here!')
          .openPopup();
      </script>
    {% else %}
      <p>Latitude and longitude not available.</p>
    {% endif %}
  {% else %}
    <p>No geolocation data available.</p>
  {% endif %}
{% endblock %}